<!DOCTYPE html>
<html>
<head>
    <title>Multiplayer TicTacToe</title>
    <style>
        body { font-family: Arial, sans-serif; background: #f0f0f0; text-align: center; }
        #board { display: grid; grid-template-columns: repeat(3, 100px); grid-gap: 10px; margin: 30px auto; }
        .cell { width: 100px; height: 100px; font-size: 2.5em; background: white; border-radius: 10px; border: 2px solid #007bff; cursor: pointer; display: flex; align-items: center; justify-content: center; }
        #status { margin: 20px; font-size: 1.2em; }
        #game-controls { margin: 20px; }
        button { padding: 10px 20px; font-size: 1em; border-radius: 5px; border: none; background: #007bff; color: white; cursor: pointer; }
    </style>
</head>
<body>
    <h1>Multiplayer TicTacToe</h1>
    <div id="game-controls">
        <button id="create">Create Game</button>
        <input id="gameIdInput" placeholder="Game ID to join" />
        <button id="join">Join Game</button>
    </div>
    <div id="status">Welcome! Create or join a game.</div>
    <div id="board"></div>
    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();
        let symbol = null;
        let gameId = null;
        const boardDiv = document.getElementById('board');
        const statusDiv = document.getElementById('status');
        const createBtn = document.getElementById('create');
        const joinBtn = document.getElementById('join');
        const gameIdInput = document.getElementById('gameIdInput');

        let board = Array(9).fill(null);

        function renderBoard() {
            boardDiv.innerHTML = '';
            board.forEach((cell, idx) => {
                const cellDiv = document.createElement('div');
                cellDiv.className = 'cell';
                cellDiv.textContent = cell || '';
                cellDiv.onclick = () => {
                    if (symbol && !cell && !statusDiv.textContent.includes('ended')) {
                        socket.emit('makeMove', idx);
                    }
                };
                boardDiv.appendChild(cellDiv);
            });
        }

        createBtn.onclick = () => {
            socket.emit('createGame');
        };

        joinBtn.onclick = () => {
            const id = gameIdInput.value.trim();
            if (id) socket.emit('joinGame', id);
        };

        socket.on('gameCreated', (data) => {
            gameId = data.gameId;
            symbol = data.symbol;
            statusDiv.textContent = `Game created! Your symbol: ${symbol}. Share Game ID: ${gameId}`;
            renderBoard();
        });

        socket.on('gameStart', (data) => {
            symbol = symbol || data.symbol;
            statusDiv.textContent = `Game started! You are ${symbol}.`;
            renderBoard();
        });

        socket.on('updateBoard', (data) => {
            board = data.board;
            if (data.winner) {
                statusDiv.textContent = data.winner === 'Draw' ? 'Game ended in a draw!' : `Player ${data.winner} wins!`;
            } else {
                statusDiv.textContent = `Turn: ${data.turn}`;
            }
            renderBoard();
        });

        socket.on('error', (msg) => {
            statusDiv.textContent = msg;
        });

        renderBoard();
    </script>
</body>
</html>